# EASYPHP

> 首先可看到是a,b,c三个参数的判断,满足条件后获取flag.a需要满足非空且a的数值大于6000000,a的长度不超过3.b需要满足b非空,并且b的md5值的后6位为8b184b.c的值是个json格式字符串,c非空,c的m键值不是数值类型且要大于2022,c的n键是一个数组,长度为2,且第1个元素也是一个数组.

## 涉及函数

### isset

> isset(value)

> 判断变量是否为空

### intval

> intval(value)

> 获取变量的整数值

### strlen

> strlen(value)

> 字符串长度

### substr

> substr(string,start,length)

> 从start位置开始获取字符串length个字符

### json_decode

> 对JSON格式的字符串进行编码

### is_array

> 判断是不是一个数组

### is_numeric

> 判断是不是数字或数字字符串

### count

> 计算数组长度

### array_search

> array_search(value,array,strict)
> 
> 在数组array中搜索value

## 思路分析

> a需要满足非空且a的数值大于6000000,a的长度不超过3.看似不可能,但是可以用科学计数法绕过,1e9是指10的9次方,所以a的值可以是1e7/8/9

> b需要满足b非空,并且b的md5值的后6位为8b184b.这个只能爆破了,得出b的值为53724

> c的值是个json格式字符串,c非空,c的m键值不是数值类型且要大于2022,c的n键是一个数组,长度为2,且第1个元素也是一个数组.is_numeric在php中判断参数是否是数值类型是否是数字或数字字符串,注意is_numeric("a123")返回false,is_numeric("123a")也返回false.c的m键值后面还要做比较,'123a'和一个整数作比较时,它会转换成123;'a123'和整数作比较时,由于第一个位置是a,非整数,php则规定其值为0,即变成了0和123比较.于是可以构造出一个c:{"m":"12345a","n":[[x],x]}.后面语句查找n键中是否有字符串'DGGJ',故n键第2个值为'DGGJ'(第1个为数组元素,所以只能第2个为'DGGJ').后面foreach遍历时候有'DGGJ'反而直接die,发现这两个条件是矛盾的.想到php弱类型特性(将一个字符串和一整数比较时会将字符串向整数转化),唯一的可能就是把"DGGJ"当作0来计算.所以n第2个元素(第1个为数组元素,所以只能第2个为0).c的值为{"m":"12345a","n":[[0,1,2],0]}

## payload

> ?a=1e9&b=53724&c={"m":"12345a","n":[[0,1,2],0]}

## flag

> cyberpeace{9caf28e673b5a40217dadf4f48474db9}