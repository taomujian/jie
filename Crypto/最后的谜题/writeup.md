# 最后的谜题

## 解题思路

> 下载附件,得到一个py文件,里面有加密方法和密文.

> 根据encrypt()可以看出对明文的每一个字符都执行相同的操作：找到在key中的位置,由随机字符串决定乘以a或者加上b(len次操作),最后定位到key中的字符

> 推导一下式子,相当于$a^k\mathrm{tmp}+x_ka^kb+x_{k-1}a^{k-1}b+\cdots+x_1ab+x_0b$

> 当随机字符串kt确定时,除了tmp都是常数,写为$P\mathrm{tmp}+Q$

> 明文前两个字符为’f{',解一个同余方程组就得到P,Q(都是模len意义下)

> 还有一种解法是,已知明文的2位(f{)和对应的密文(Wh),可以把a,b,kt爆破出来

> 在模运算中,除法运算并不是与乘法运算互逆的.模运算中的除法是取整数商的操作,并不能还原乘法运算的结果.乘法逆元是一个数论概念,它是乘法操作的真正逆元素,可以恢复乘法操作的结果.通过计算乘法逆元,我们可以将乘法操作的影响完全消除,从而正确还原出加密过程中的原始明文字符.

## flag

> hsctf{th3_l4st_s3c5et_0f_4he_un1ve2se_1s_42}
