# SimpleRSA

## 解题思路

> 下载附件,解压得到1个py文件,里面能看到一些加密信息,分为4段

> 第1段由q = next_prime(getPrime(16) * p + 38219)可知,q为p*getPrime(16)+38219的下一个素数,因此getPrime(16)较小,所以我们可以在其取值范围为遍历出符合题目的值,从而解出q,从而求出E1

> 第2段,是低指数加密广播攻击(e很小, 多组n,c),根据之前的题目,很快求得E2(也可以通过中国剩余定理求)

> 第3段本来是出题者想出p高位然后去求P的,但是在第4段代码中出了纰漏,n1 = P * Q1和n2 = P * Q2这两个n有共同的因子P,所以可以直接求他们的最大公约数得到P,即P=gmpy2.gcd(n1,n2),则分别可以求出Q1=n1//P和Q2=n2//P

> 计算E1和phi1,E2和phi2发现都等于35,不能够直接求私钥d了,而且求出来的m直接开35次方也得不到flag

> 处理这个35,先将E除掉35后求出m^35的值,然后分别对P,Q1,Q2取模得到3个m,然后用中国剩余定理求出m4

## flag

> flag{27dab675-9e9b-4c1f-99ab-dd9fe49c190a}