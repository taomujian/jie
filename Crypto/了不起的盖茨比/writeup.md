# 了不起的盖茨比

## 解题思路

> 下载附件,得到一个py文件,题目逻辑简单,是用aes的ebc模式加密,但是加密的字符是经过iv进行异或的,就是不知道怎么找到iv,看wqp发现是要用到MTP攻击原理.

> 准备一个key字符串,然后利用key去异或相同长度的明文,即得到密文.如果每个密文都利用新的key去加密,那么这种方式称为"一次一密"（One-Time-Pad）.OTP是无条件安全的：即使攻击者拥有无限的计算资源,都不可能破译OTP加密的密文.

> 然而,一次一密的密钥分发是比较困难的.首先,Alice想要给Bob发送长度为n的信息,则必须在这之前传送长度为n的密钥,相当于传输的数据总量翻了倍.其次,尽管密文是无条件安全的,但密钥的传输信道未必是安全的,攻击者一旦窃听了密钥,则可以解密密文.

> 那么马上就可以想到一个投机取巧的方法——Alice造一个比较长的密钥,然后用非常秘密的方式告诉Bob.接下来,Alice每次向Bob发送信息,都把明文异或上这个约定好的字符串；Bob收到信息之后,把密文异或上key,于是就可以拿到明文.整个过程只需要传送一次密钥,这是很方便的.这种方式称为 Many-Time-Pad (MTP).

> 很遗憾,上述的MTP办法是不安全的.攻击者如果截获了足够多的密文,就有可能推断出明文、进而拿到密钥.这个缺陷是异或运算的性质带来的.

> 从给出的py文件中可以看到,异或的都是同一个iv,就可以通过MTP求出iv

## flag

> CatCTF{This's_why_PCBC_is_not_living}

## 参考

> https://www.ruanx.net/many-time-pad/

> https://blog.csdn.net/m0_63303407/article/details/127193042