# Onetimepad2

## è§£é¢˜æ€è·¯

> ä¸‹è½½é™„ä»¶,å¾—åˆ°ä¸€äº›åŠ å¯†å­—ç¬¦ä¸²å’Œä¸€ä¸ªåŠ å¯†çš„pyè„šæœ¬

> åˆ†æå‡½æ•°process(m,k):

```
def process(m, k):
    tmp = m ^ k
    res = 0
    for i in bin(tmp)[2:]:
        res = res << 1;
        if (int(i)):
            res = res ^ tmp
        if (res >> 256):
            res = res ^ P
    return res
```

> res = res << 1ä»£è¡¨ä¹˜ä»¥x,å¤šé¡¹å¼çš„ç³»æ•°å…¨ä½“å·¦ç§»ä¸€ä½

> if (int(i)):res^=tmpç­‰ä»·äºres^=int(i)*tmp,ä»£è¡¨+ğ‘¡<sub>ğ‘–</sub>â‹…ğ‘“<sub>ğ‘¡</sub>

> if (res>>256):res^=Pä»£è¡¨æ¨¡æœ¬åŸå¤šé¡¹å¼g

> ç»¼ä¸Š,process(m,k)å®é™…ä¸Šå®ç°äº†ğºğ¹(2<sup>256</sup>)ä¸Šçš„å…ƒç´ ğ‘šä¸ğ‘˜ä¹‹å’Œçš„å¹³æ–¹(ğ‘š+ğ‘˜)<sup>2</sup>

> è§£å¯†è¿‡ç¨‹:


ğ‘˜<sub>2</sub>=(ğ‘˜<sub>1</sub>+ğ‘ ğ‘’ğ‘ğ‘Ÿğ‘’ğ‘¡)<sup>2</sup>,ğ‘˜<sub>3</sub>=(ğ‘˜<sub>2</sub>+ğ‘ ğ‘’ğ‘ğ‘Ÿğ‘’ğ‘¡)<sup>2</sup>
(åœ¨GF(2<sup>256</sup>)ä¸Šçš„è¿ç®—)

ğ‘<sub>1</sub>=ğ‘š<sub>1</sub>âŠ•ğ‘˜<sub>1</sub>,ğ‘<sub>2</sub>=ğ‘š<sub>2</sub>âŠ•ğ‘˜<sub>2</sub>,ğ‘<sub>3</sub>=ğ‘š<sub>3</sub>âŠ•ğ‘˜<sub>3</sub>
,å…¶ä¸­ğ‘<sub>i</sub>(ğ‘–=1,2,3),ğ‘š<sub>i</sub>(ğ‘–=1,2)
å·²çŸ¥

åˆ™ğ‘˜<sub>2</sub>=ğ‘š<sub>2</sub>âŠ•ğ‘<sub>2</sub>,ğ‘˜<sub>3</sub>=ğ‘š<sub>3</sub>âŠ•ğ‘<sub>3</sub>
,å¯è§£å‡ºsecretï¼šğ‘ ğ‘’ğ‘ğ‘Ÿğ‘’ğ‘¡=ğ‘˜<sub>3</sub><sup>1/2</sup>+ğ‘˜<sub>2</sub>
(åœ¨GF(2<sup>256</sup>)ä¸Šçš„è¿ç®—)

æ¥ä¸‹æ¥è§£å‡ºğ‘˜<sub>1</sub>
ï¼šğ‘˜<sub>1</sub>=ğ‘˜<sub>2</sub><sup>1/2</sup>+ğ‘ ğ‘’ğ‘ğ‘Ÿğ‘’ğ‘¡
(åœ¨GF(2<sup>256</sup>)ä¸Šçš„è¿ç®—)


> ä»¥ä¸Šæ˜¯onetimepadé¢˜ç›®åŠ å¯†çš„åšæ³•,è¿™é“é¢˜ç›®ä¾ç„¶ç”¨åˆ°äº†ä¸Šé¢çš„çŸ¥è¯†.

> process1(m,k)æ˜¯ä¸€ä¸ªä¹˜æ³•GF(2^128).ä»”ç»†è§‚å¯Ÿprocess2å¯ä»¥å‘ç°å®ƒåªæ˜¯ä¸¤ä¸ª2Ã—2çŸ©é˜µçš„ä¹˜æ³•.

> nextrandåšä»€ä¹ˆï¼Ÿå®ƒå®ç°äº†ä¸€ä¸ªå¿«é€Ÿçš„æŒ‡æ•°è¿ç®—.nextrand(rand) = M^N [0,0] . rand + M^N [0,1],è€Œä¸”Nä¹Ÿæ›´æ–°ä¸ºN^2.ä½¿ç”¨çš„M^Nå€¼æ˜¯å¤šå°‘ï¼Ÿè±¡å¾æ€§åœ°çœ‹ä¸€ä¸‹Mçš„å¹‚ï¼š

![å›¾ç‰‡](1.jpg)

> ç¬¬ä¸€ä¸ªæ¡ç›®åªæ˜¯ä¸€ä¸ªA^N,ç¬¬äºŒä¸ªæ¡ç›®ç­‰äºB(A^(N-1)+A^(N-2)+...+1) = B(A^N -1)/(A-1),å› æ­¤,æˆ‘ä»¬æœ‰ä»¥ä¸‹æ–¹ç¨‹å¼ï¼š

> è¿™é‡ŒNæ˜¯æœªçŸ¥çš„,ä½†ä¸èƒ½ç›´æ¥æ±‚è§£.å…ˆè§£ä¸€ä¸ª^N,ç„¶åè§£ä¸€ä¸ªç¦»æ•£å¯¹æ•°é—®é¢˜.

> æŠŠç¬¬äºŒä¸ªæ–¹ç¨‹ä¹˜ä»¥ï¼ˆA-1ï¼‰

> å› æ­¤å¯ä»¥è®¡ç®—A^N.è¦å¾—åˆ°N,éœ€è¦è®¡ç®—GFï¼ˆ2^128ï¼‰ä¸­çš„ç¦»æ•£å¯¹æ•°.æœ‰æ¬¡æŒ‡æ•°ç®—æ³•,æ‰€ä»¥128ä½çš„å¤§å°æ˜¯ç›¸å½“å®ç”¨çš„.å®é™…ä¸Š,sageå¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…å®Œæˆï¼š

## flag

> flag{LCG1sN3ver5aFe!!}