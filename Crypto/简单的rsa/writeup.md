# 简单的rsa

## 解题思路

> 下载附件,得到一个py文件

> 这道题现在挺容易的,直接在线分解能得到p和q,直接得到flag.但是这道题目比赛的时候在线分解网站是没有收录.

> 加密函数的大致过程是先生成两个2048位的大素数p、q,计算出重要参数n、phi_n、e和 d,再通过destory()函数产生新的p和q,并计算出新的n,最后再通过new_n对flag加密得到enc_flag

> 题目给出n、e、d以及new_n,通过其中的n、e和d(关键,一般题目不会给出私钥)就可以通过脚本计算出p、q

> 得到p、q后还需要知道new_p和new_q,分析函数destory(x, num),函数算法是生成一个900位的随机数与原来2048位的p和q进行异或,将新得到的素数作为new_p和new_q；因此,new_p和new_q与原p、q的高1148位相同,只有低位900个bit不一样,通过已知高位攻击(大佬现成的exp)计算出new_p

> 从而直接获取flag

## flag

> flag{6b1ff461dc15e5476cafe887189178e3924dad84}