# Streamgame1

## 解题思路

> 下载附件,得到一个py和加密文件,py文件里是一个线性反馈移位寄存器

> 线性反馈移位寄存器（LFSR）归属于移位寄存器（FSR）,除此之外还有非线性移位寄存器（NFSR）.移位寄存器是流密码产生密钥流的一个主要组成部分.上一个n级反馈移位寄存器由n个二元存储器与一个反馈函数组成.

> 移位寄存器的三要素:

```
初始状态: 由用户确定
反馈函数: 是n元布尔函数,即函数的自变量和因变量只取0和1这两个可能值
输出序列
```

> 如果反馈函数是线性的,那么我们称其为LFSR

> 由LFSR的输出序列{}满足的条件知可知,输出值的结果与c的值相关,即题目中的mask.只有当c的值为1时,的值才可能为1,题目中mask中只有第（3,4,5,9,13,14,17,19）位为1,其余都是0(mask这里右边才是第一位,从右往左增大)

> 现在我目的就是为了求出前19位seed的值,而已知了seed后面输出序列的值（题目中给的附件key.txt）.那么逆推就能得到seed的值了.lfsr(R,mask)函数执行的是19bits的值.那么获取到输出序列前19bits值,即：key = 0101010100111000111

> 现在需要计算的值,假设将 R =,进行lfsr(R,mask)运算,那么将得到输出值为 key[-1]=1.

> 因为mask中只有第（3,4,5,9,13,14,17,19）位为1,所以线性反馈函数只取这几位对应,1=^(R[-3])^(R[-4])^(R[-5])^(R[-9])^(R[-13])^(R[-14])^(R[-17])

> 得1=^0,得到=1

> 同理：R =的输出值为 key[-2]=1,求得=1

> 由于flag未知位置只有19位,可以爆破的,加密后和key进行对比就可以了.

## flag

> flag{1110101100001101011}

## 参考

> https://zhuanlan.zhihu.com/p/594717025

> https://ctf-wiki.org/crypto/streamcipher/fsr/lfsr/