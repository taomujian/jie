# SSSP

## 解题思路

>  在线场景已经打不开了
> 这个题目与Tokyo Westerns 2017 CTF problem(https://github.com/ymgve/ctf- writeups/tree/master/tokyowesterns2017/ppc-backpackers_problem)十分相似.我们已经处理了三十种不同的子集和问题,大小从11到127个整数不等,这些问题都是从标准 Mersenne Twister伪随机数生成器变量MT19973衍生而来的.一下是一些关键的不同之处：

```
MT不是由单个32位种子初始化的,真个642-整数都是从一个安全的RNG源生成而来的.
题目集中的整数位数从24到120位不等.
整数列表中的数字并没有经过排序,所以我们是可以清楚地知道部分PRNG的.
```

> 既然这个问题并非单一种子类型的,我们可以假定PRNG状态是由问题中的整数递增而成的,我们希望可以在整个问题集变得太大之前恢复出整个状态.我们不以标准624整数状态看这个问题,我们把Twister看作是一个不定长度的数组,每个入口都是一个在当前时刻包含所有可能整数的数组,或者说没有一个可能的数字特别大.比方说,如果我们知道了这个时刻32位中的24位,我们就可以知道这个时刻的状态值只是256个不同状态中的一个.

> 我们运用state[x]由state[x-624]、state[x-227]和state[x-623]为基础生成,而state[x-624]仅仅对结果贡献单一的以为,所以最差的情况就是它会有两个可能值.对于其他别的整数,如果我们知道(state[x-623], state[x-227], state[x])中的两个,我们可以计算出这个数组中的第三个.如果这个导致可能的数组数量下降,我们就反复对不同的x重复这个过程,知道得不到更好的组合为止.我们要为这个过程设置一个时间上限,以免运行时间过长.

> 等到我们确定了预测值,就可以以一个一般的的子集和问题来做了.我们应该去使用一些比一般Python更加高效的语言来实现这个解题思路,我们的预测值会生成结果于是就可以在问题集中去除这些结果了.

> 在问题十四时,问题集合被缩减至50,但这还是太多了.所以我们决定放弃最后七个数字,把问题集缩减到43.虽然这意味着128次中会失败127次,但是通过多次运行,在问题20中,整个PRNG就已经得到了.最终得到了flag：hitcon{SSSP = Silly Shik's Superultrafrostified Present}.

## flag

> hitcon{SSSP = Silly Shik's Superultrafrostified Present}

> 攻防世界上预留的答案和flag不一样

